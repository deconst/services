# Deconst Service Dockerfiles

*Hand-crafted artisanal Dockerfiles for non-core services*

This repository is home to the Dockerfiles for deconst services that aren't used for software written for deconst itself, but also don't have official Docker images in the Dockerhub registry.

## Curator

[![Docker Repository on Quay.io](https://quay.io/repository/deconst/curator/status "Docker Repository on Quay.io")](https://quay.io/repository/deconst/curator)

This image bundles [Elasticsearch Curator](https://www.elastic.co/guide/en/elasticsearch/client/curator/current/index.html) and some utility scripts to quickly prune old Elasticsearch indexes.

## Nginx

[![Docker Repository on Quay.io](https://quay.io/repository/deconst/nginx/status "Docker Repository on Quay.io")](https://quay.io/repository/deconst/nginx)

An [nginx](http://nginx.org/en/docs/) server configured to proxy requests to a presenter and content service within a pod.

```bash
docker run -d \
  --volume /my-certs/:/var/ssl:ro \
  --link content:content \
  --link presenter:presenter \
  quay.io/deconst/nginx
```

## Strider

[![Docker Repository on Quay.io](https://quay.io/repository/deconst/strider/status "Docker Repository on Quay.io")](https://quay.io/repository/deconst/strider)

This image bundles [Strider CD](https://github.com/Strider-CD/strider) with a controlled set of plugins and build scripts that can build content and control repositories. When launched, it bootstraps Strider with a system user and a project that builds the control repository.

#### Configuration

Mandatory configuration values:

* `STRIDER_SYSTEM_EMAIL` Email address used to identify the system user. This is primarily cosmetic.
* `GITHUB_SYSTEM_TOKEN` A [personal access token](https://github.com/settings/tokens) generated by the GitHub user that will be used for Strider cloning and GitHub interactions.
* `CONTENT_SERVICE_URL` URL of the content service for this Deconst deployment.
* `ADMIN_API_KEY` Content service API key with administrative credentials.
* `CONTROL_REPO_URL` Git clone URL of the control repository for this Deconst deployment.

Optional configuration values:

* `CONTROL_REPO_BRANCH` Primary build branch of the control repo. Default: *master*
* `SLACK_WEBHOOK_URL` If provided, the control repo build will notify this Slack webhook.
* `SLACK_CHANNEL` If provided, this Slack channel will be notified by automatically created builds.
* `GITHUB_API_ENDPOINT` Root endpoint of the GitHub API. Change this to target a GitHub: Enterprise instance. Default: *https://api.github.com*
